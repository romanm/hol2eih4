<!DOCTYPE html>
<html ng-app="hol2eih3App" ng-controller="OperationCodeCtrl as operationCodeCtrl">
<head>
<meta charset="utf-8" />
<link rel="stylesheet" href="/v/lib/css/bootstrap.min.css"></link>
<link rel='stylesheet prefetch' href='/v/lib/css/font-awesome.min.css' />
<link rel="stylesheet" href="/v/css/ui.css"></link>
<link rel="stylesheet" href="/v/css/hol2eih3.css"></link>
<link rel="stylesheet" href="/v/css/navbar_horizontal_gray.css" />
<style type="text/css" media="screen"></style>
<script type="text/javascript">
var viewTab = "editOperation";
</script>
<title>Кодування хірургічних (оперативних) втручаннь.</title>
</head>
<body>
<div id="menu-fix-top" class="no-print">
		<div class="navcontainer">
			<ul>
				<li><a href="/"><i class="fa fa-home" aria-hidden="true"></i> ХОЛ <i class="fa fa-angle-double-right"
						aria-hidden="true"></i></li>
				<li>
					<div class="tooltip2">
						<a href="#"> <i class="fa fa-angle-double-down"
							aria-hidden="true"></i> список пацієнтів
						</a>
						<div class="tooltiptext2">
							<div
								ng-repeat="patient in model.departmentPatient.departmentPatients">
								<a href="?ix={{patient.history_id}}"
								title="{{$index + 1}}"
								> {{patient.history_no}}
									: {{patient.name}} </a>
							</div>
						</div>
					</div>
				</li>
				<li>|
				{{model.principal.name}}
				</li>
				<li data-ng-if="!model.principal"><span
					class="glyphicon glyphicon-log-in"></span> 
					<a href="{{loginToThisPage()}}"> Ввійти </a></li>
				<li data-ng-show="model.principal" class="ng-binding ng-hide"><span
					class="glyphicon glyphicon-log-out"></span> : <a
					href="/logout"> Вийти </a></li>
			</ul>
		</div>
	</div>
	<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<span title="Хмельницька обласна лікарня"> <i
					class="fa fa-home" aria-hidden="true"></i> ХОЛ
				</span> <span ng-if="ix.historyMap.patient_surname"> <i class="fa fa-angle-double-right"
					aria-hidden="true"></i>
					{{ix.historyMap.history_no}}:<b>
					{{ix.historyMap.patient_surname}}
					{{ix.historyMap.patient_name}}
					{{ix.historyMap.patient_patronnymic}}
					</b>
				</span>
			</div>
		</div>
	</nav>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
			<!-- 
				<h1>Електронна історія хвороби</h1>
			 -->
				<h1></h1>
				<ul class="navbar_horizontal_gray">
					<li><a ng-class="{'active': viewTab == 'editIx'}" href="/v/eix/{{param.ix}}"
						ng-click="viewTab = 'linking'">Ваписка</a></li>
					<li><a ng-class="{'active': viewTab == 'editOperation'}"
						title="Кодування хірургічних (оперативних) втручаннь."
						href="/h/operation-code.html{{param.ix?'?ix='+param.ix:''}}">Кодування
							операція </a></li>
					<li><a> {{param.ix}} </a></li>
				</ul>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6">
			<!-- 
				<h2>Перегляд</h2>
			 -->
				<div>
					Кількість Операцій: {{ix.operationHistoryList.length}} 
					|
					<a ng-click="addOperation()">
					Додати операцію
					</a>
					<hr/>
					<div ng-repeat="operation in ix.operationHistoryList"
						ng-click="useOperation(operation)">
						<div>{{operation.operation_history_start | date:'dd.MM.yyyy, HH:mm'}} 
						{{operation.operation_history_end | date:' - HH:mm'}}
							({{calcOperationDurationHHmm(operation)}})</div>
						<div>
							<a ng-class="{'selected-to-save': openedToEdit == 'operation'}"
								ng-click="editOperation()">{{fieldsOperation['operation']}}</a>:
							<!-- 
								<span class="glyphicon glyphicon-alert" aria-hidden="true"></span>
								<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
								 -->
							<span class="alert-danger" ng-if="!operation.operation_id">
								<i class="fa fa-exclamation-circle" aria-hidden="true"></i>
								Невідмінно
							</span> <span ng-if="operation.procedure.procedure_id"> <b>{{operation.procedure.procedure_code}}</b>:
								{{operation.procedure.procedure_name}} <br />
							</span> <span ng-if="operation.procedure.PROCEDURE_ID"> <b>{{operation.procedure.PROCEDURE_CODE}}</b>:
								{{operation.procedure.PROCEDURE_NAME}} <br />
							</span> <strike> <b> {{operation.operation_code}} </b>
								{{operation.operation_name}}
							</strike>
							<div>{{operation.operation_additional}}</div>
							<a ng-class="{'selected-to-save': openedToEdit == 'icd'}"
								ng-click="openToEdit('icd')">{{fieldsOperation['icd']}}</a> : <span
								class="alert-danger" ng-if="!operation.icd_code"> <i
								class="fa fa-exclamation-circle" aria-hidden="true"></i>
								Невідмінно
							</span> <b> {{operation.icd_code}} </b> {{operation.icd_name}}
							<div>{{operation.icd_additional}}</div>
							<div>
							<span class="tooltip2"> 
								<a ng-class="{'selected-to-save': openedToEdit == 'department'}"
									ng-click="openToEdit('department')">{{fieldsOperation['department']}}</a>:
									<div class="tooltiptext3">
										<div ng-repeat="value in model.operationEditLists.departmentOperation">
											<a ng-click="changeDepartment(value)"
												title="{{surgery.cnt}}">
												{{value.department_name}} </a>
										</div>
									</div>
								</span>
								<span class="alert-danger" ng-if="!operation.department_id">
									<i class="fa fa-exclamation-circle" aria-hidden="true"></i>
									Невідмінно
								</span> {{operation.department_name}}, <span class="tooltip2"> <a
									ng-class="{'selected-to-save': openedToEdit == 'surgery'}"
									ng-click="openToEdit('surgery')">{{fieldsOperation['surgery']}}</a>:
									<div class="tooltiptext3">
										<div ng-repeat="surgery in model.operationEditLists.departmentSurgery">
											<a ng-click="changeSurgery(surgery)"
												title="{{surgery.cnt}}">
												{{surgery.personal_username}} </a>
										</div>
									</div>
								</span> <span class="alert-danger" ng-if="!operation.personal_id">
									<i class="fa fa-exclamation-circle" aria-hidden="true"></i>
									Невідмінно
								</span>
								 {{operation.surgery_name}}
							</div>
							<div>
								<span class="tooltip2"> <a
									ng-class="{'selected-to-save': openedToEdit == 'anesthetist'}"
									ng-click="openToEdit('anesthetist')">{{fieldsOperation['anesthetist']}}</a>:
									<div class="tooltiptext3">
										<div
											ng-repeat="anesthetist in model.operationEditLists.departmentAnesthetist">
											<a ng-click="changeAnesthetist(anesthetist)"
												title="{{anesthetist.cnt}}">
												{{anesthetist.personal_username}} </a>
										</div>
									</div>

								</span> {{operation.anesthetist_name}}, <span class="tooltip2">
									<a ng-class="{'selected-to-save': openedToEdit == 'anestesia'}"
									ng-click="openToEdit('anestesia')">{{fieldsOperation['anestesia']}}</a>:
									<div class="tooltiptext3">
										<div
											ng-repeat="anesthesia in model.operationEditLists.anesthesia">
											<a ng-click="changeAnesthesia(anesthesia)"
												title="{{anesthesia.cnt}}">
												{{anesthesia.anestesia_name}} </a>
										</div>
									</div>
								</span> <span class="alert-danger" ng-if="!operation.anestesia_id">
									<i class="fa fa-exclamation-circle" aria-hidden="true"></i>
									Невідмінно
								</span> {{operation.anestesia_name}}
							</div>
							<div>
								<span class="tooltip2">
								<a ng-class="{'selected-to-save': openedToEdit == 'result'}"
									ng-click="openToEdit('result')">{{fieldsOperation['result']}}</a>: 
									<div class="tooltiptext3">
										<div
											ng-repeat="result in model.operationEditLists.result">
											<a ng-click="changeResult(result)"
												title="{{result.cnt}}">
												{{result.result_name}} </a>
										</div>
									</div>
								</span>
								<span class="alert-danger" ng-if="!operation.operation_result_id">
									<i class="fa fa-exclamation-circle" aria-hidden="true"></i>
									Невідмінно
								</span>
								{{operation.operation_result_name}}, <a
									ng-class="{'selected-to-save': openedToEdit == 'complication'}"
									ng-click="openToEdit('complication')">{{fieldsOperation['complication']}}</a>
								: {{operation.operation_complication_name}}
							</div>
						</div>
						<hr />
					</div>
				</div>
			</div>
			<div class="col-md-6">
				<h2>
					Редагування <small ng-if="openedToEdit" class="selected-to-save">{{fieldsOperation[openedToEdit]}}</small>
				</h2>
				<div ng-if="openedToEdit == 'operation'">
					<div ng-if="procedureToSave.PROCEDURE_ID>0">
						<span class="selected-to-save"> <b>
								{{procedureToSave.PROCEDURE_CODE}}: </b>
							{{procedureToSave.PROCEDURE_NAME}}
						</span>
					</div>
					<div ng-if="procedureToSave.procedure_id>0">
						<span class="selected-to-save"> <b>
								{{procedureToSave.procedure_code}}: </b>
							{{procedureToSave.procedure_name}}
						</span>
					</div>
					<table class="column">
						<tr>
							<th>Пошук:</th>
							<th>Додатково:</th>
						</tr>
						<tr>
							<td><input ng-model="operationCodeCtrl.seekOperation" /> <a>Поновити
									пошук</a> {{seekProcedure.seekProcedure.length}}</td>
							<td><textarea rows="2" cols="40">
At w3schools.com you will learn how to make a website. We offer free tutorials in all web development technologies.
</textarea></td>
						</tr>
					</table>
					
					<div ng-if="operationCodeCtrl.seekOperation.length > 0 && seekProcedure.seekProcedure.length < 200">
						<div class="code-item"
							ng-repeat="p in seekProcedure.seekProcedure | filter:{PROCEDURE_CODE:filterCode}"
							ng-class="{'procedure-group': isProcedureGroup(p.PROCEDURE_CODE)}">
							<span
								ng-class="{'code':!isProcedureGroup(p.PROCEDURE_CODE),'selected-to-save':isToSaveProcedure(p)}"
								ng-click="toSaveProcedure(p)"> <b
								ng-class="{'saved': mapProcedureOperation.p[p.PROCEDURE_CODE] >= 0}">
									{{p.PROCEDURE_CODE}}</b> : 
									{{p.PROCEDURE_NAME}}
							</span>
						</div>
					</div>
					<div
						ng-if="operationCodeCtrl.seekOperation == null || operationCodeCtrl.seekOperation.length == 0 || seekProcedure.seekProcedure.length >= 200">
						<ul class="code-item">
							<li ng-repeat="medprocedure in procedureOperation.procedure"
								title="{{medprocedure.procedure_id}}"><span
								ng-click="openChildProcedureDb(medprocedure)">
									{{medprocedure.procedure_code}} :
									{{medprocedure.procedure_name}} </span>
								<ul ng-if="medprocedure.open">
									<li ng-repeat="medprocedure2 in medprocedure.procedure"
										title="{{medprocedure2.procedure_id}}"><span
										ng-click="openChildProcedureDb(medprocedure2)">
											{{medprocedure2.procedure_code}} :
											{{medprocedure2.procedure_name}} </span>
										<ul ng-if="medprocedure2.open">
											<li ng-repeat="medprocedure3 in medprocedure2.procedure"
												title="{{medprocedure3.procedure_id}}"><span
												ng-click="openChildProcedureDb(medprocedure3)">
													{{medprocedure3.procedure_code}} :
													{{medprocedure3.procedure_name}} </span>
												<ul ng-if="medprocedure3.open">
													<li ng-repeat="medprocedure4 in medprocedure3.procedure"
														title="{{medprocedure4.procedure_id}}"><span
														ng-class="{'selected-to-save':isToSaveProcedure(medprocedure4)}"
														ng-click="openChildProcedureDb(medprocedure4)">
															{{medprocedure4.procedure_code}} :
															{{medprocedure4.procedure_name}} </span>
														<ul ng-if="medprocedure4.open">
															<li ng-repeat="medprocedure5 in medprocedure4.procedure"
																title="{{medprocedure5.procedure_id}}"><span
																ng-click="openChildProcedureDb(medprocedure5)">
																	{{medprocedure5.procedure_code}} :
																	{{medprocedure5.procedure_name}} </span>
																<ul ng-if="medprocedure5.open">
																	<li
																		ng-repeat="medprocedure6 in medprocedure5.procedure"
																		title="{{medprocedure6.procedure_id}}"><span
																		ng-click="openChildProcedureDb(medprocedure6)">
																			{{medprocedure6.procedure_code}} :
																			{{medprocedure6.procedure_name}} </span></li>
																</ul></li>
														</ul></li>
												</ul></li>
										</ul></li>
								</ul></li>
						</ul>
					</div>
				</div>
				<div >
				{{openedToEdit}}
				</div>
			</div>
		</div>
	</div>
	<nav class="navbar navbar-default navbar-fixed-bottom"
		role="navigation">
		<div class="container">
			<span><span class="glyphicon glyphicon-console"></span> &nbsp;
				&nbsp; </span>
			<ol class="list-inline navbar-right">
				<li>|
				{{model.principal.name}}
				</li>
				<li data-ng-if="!model.principal"><span
					class="glyphicon glyphicon-log-in"></span>
					<a href="{{loginToThisPage()}}"> Ввійти </a></li>
				<li data-ng-show="model.principal" class="ng-binding ng-hide"><span
					class="glyphicon glyphicon-log-out"></span> : <a
					href="/logout"> Вийти </a></li>
			</ol>
		</div>
	</nav>
</body>
<script src="/v/lib/js/jquery-2.2.4.min.js"></script>
<script src="/v/lib/js/bootstrap.min.js"></script>
<script src="/v/lib/js/angular.min.js"></script>
<script src="/v/lib/js/angular-locale_uk.js"></script>
<script src='/v/lib/js/textAngular.min.js'></script>
<script src='/v/lib/js/textAngular-sanitize.min.js'></script>
<script src='/v/lib/js/textAngular-rangy.min.js'></script>
<script src='/v/js/hol2eih3.declare.js'></script>
<script src='/v/js/hol2eih3.controller.js'></script>
</html>
